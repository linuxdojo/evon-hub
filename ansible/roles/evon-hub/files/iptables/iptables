*nat
:PREROUTING ACCEPT
:INPUT ACCEPT
:POSTROUTING ACCEPT
:OUTPUT ACCEPT
-A POSTROUTING -o tun0 -s 10.{{ subnet_id }}.0.0/17 -j MASQUERADE
-A POSTROUTING -o tun1 -s 10.{{ subnet_id }}.0.0/17 -j MASQUERADE
COMMIT
*raw
:PREROUTING ACCEPT
:OUTPUT ACCEPT
COMMIT
*mangle
:PREROUTING ACCEPT
:INPUT ACCEPT
:FORWARD ACCEPT
:OUTPUT ACCEPT
:POSTROUTING ACCEPT
COMMIT
*filter
:INPUT ACCEPT
:FORWARD ACCEPT
:OUTPUT ACCEPT
-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
-A INPUT -p icmp -j ACCEPT
-A INPUT -i lo -j ACCEPT
-A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT
-A INPUT -p tcp -m state --state NEW -m tcp --dport 80 -j ACCEPT
-A INPUT -p tcp -m state --state NEW -m tcp --dport 443 -j ACCEPT
-A INPUT -p udp -m state --state NEW -m udp --dport 1194 -j ACCEPT
-A INPUT -p tcp -m state --state NEW -m tcp -s 10.{{ subnet_id }}.0.0/16 --dport 3128 -j ACCEPT
-A INPUT -j REJECT --reject-with icmp-host-prohibited
-A FORWARD -m state --state RELATED,ESTABLISHED -j ACCEPT
-A FORWARD -s 10.{{ subnet_id }}.0.0/17 -j ACCEPT
# example allowing single host 10.{{ subnet_id }}.128.54/32 to be reachable on TCP/10050 from any evon endpoint
#-A FORWARD -d 10.{{ subnet_id }}.128.54/32 -p tcp -m tcp --dport 10050 -j ACCEPT
#-A FORWARD -s 10.{{ subnet_id }}.128.54/32 -p tcp -m tcp --dport 10050 -j ACCEPT
-A FORWARD -s 10.{{ subnet_id }}.128.0/17 -j REJECT --reject-with icmp-port-unreachable
COMMIT
